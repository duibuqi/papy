This is a single file implementation.
All functions are moved into pa.py
